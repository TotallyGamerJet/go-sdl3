# Contribute

See [COVERAGE.md](COVERAGE.md) for the list of fonctions that are and are not implemented yet.

## Structure

- A json description of SDL3 API is generated ([`ffi/sdl.json`](cmd/ffi2go/ffi/sdl.json)) using [c2ffi](https://github.com/rpav/c2ffi) from [docker](Dockerfile).
- The [API quick reference](https://wiki.libsdl.org/SDL3/QuickReference) is downloaded within [cmd/ffi2go](cmd/ffi2go/) and serves as a base to determine the list of API functions.
- All `*.gen.go` files are generated by running [cmd/ffi2go](cmd/ffi2go/), it uses both `ffi.json` and the quick api reference file.
- Function wrapped implementations can be found in [functions.go](functions.go) and [methods.go](methods.go). I'm not sure about the names, or this organization at all, suggestions are welcome!
- [methods.go](methods.go) contains pointer receiver functions, some don't make sense as they have been generated as a starting point by [cmd/methodgen](cmd/methodgen/) and need tweaking. Most of these methods `panic` and need a developer input to be sanitized (idiomatic Go) and checked against SDL3 spec.
- [sdl_functions_js.go](sdl_functions_js.go) is in a similar state as methods.go, most of the code has been generated as a starting point but need to be fixed, sanitized and mostly tested. For this reason most of the functions panic by default.
- Functions are defined unexposed (with a `i` prefix) and registered to [purego](https://github.com/ebitengine/purego), they have a comment when they require a call to `internal.Free` (you can also find the list of functions requiring sdlFree, in ffi2go/config json files).
- [extra.go](extra.go) contains glue code that couldn't be generated efficiently.

Feel free, to help for testing, examples, expose some functions.
Also to help re-organize, rename, refactor, as some directions have been taken arbitrarily.

## Generate

### Bindings
- `go install github.com/go-task/task/v3/cmd/task@latest`
- `task gen-bindings LIBRARY="sdl"`
- `task gen-bindings LIBRARY="ttf"`
- `task gen-bindings LIBRARY="img"`
- `task gen-bindings LIBRARY="mixer"`

### Other commands
- `task gen-ffi LIBRARY="sdl"`
- `task gen-doc LIBRARY="sdl"`
- `task coverage`